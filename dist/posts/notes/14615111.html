<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solution -「CF 392C」Yet Another Number Sequence | 汪站</title>
    <link rel="stylesheet" href="../output.css" />
  </head>
  <body>
    <script>
      MathJax = {
        tex: {
          inlineMath: [
            ["$", "$"],
            ["\\(", "\\)"],
          ],
        },
      };
    </script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <h1>Solution -「CF 392C」Yet Another Number Sequence</h1><h2>Description</h2>
<p><a href="http://codeforces.com/problemset/problem/392/C">Link</a>.</p>
<p>求 $\sum_{i=1}^{n}\text{fibonacci}<em>{i}\times i^{k}=\sum</em>{i=1}^{n}(F_{i-1}+\text{fibonacci}_{i-2})\times i^{k}$，$1\le n\le10^{17},1\le k\le40$。</p>
<h2>Solution</h2>
<p>简记 $F_{i}=\text{fibonacci}_{i}$。首先我们作个差：</p>
<p>$
ans_{n}=\sum_{i=1}^{n}F_{i}\times i^{k}=\sum_{i=1}^{n}(F_{i-1}+F_{i-2})\times i^{k} \
ans_{n}-ans_{n-1}=F_{n}\times n^{k} \
$</p>
<p>然后：</p>
<p>$
\begin{aligned}
ans_{n}&amp;=ans_{n-1}+F_{n}\times n^{k} \
&amp;=ans_{n-1}+F_{n-1}\times(n-1+1)^{k}+F_{n-2}\times(n-2+2)^{k} \
&amp;=ans_{n-1}+\left(\sum_{i=0}^{k}A_{i-1}(i)\times\binom{k}{i}\right)+\left(\sum_{i=0}^{k}A_{i-2}(i)\times\binom{k}{i}\times2^{k-i} \right)
\end{aligned}
$</p>
<p>后面的 dirty work 实在不想做，口胡选手选择放弃。</p>
<pre><code class="language-cpp">Oops, something went wrong.
</code></pre>

    <script src="../components/layout.js"></script>
  </body>
</html>
