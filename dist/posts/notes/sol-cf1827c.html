<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solution -ã€ŒCF 1827Cã€Palindrome Partition | æ±ªç«™</title>
    <link rel="stylesheet" href="../output.css" />
  </head>
  <body>
    <script>
      MathJax = {
        tex: {
          inlineMath: [
            ["$", "$"],
            ["\\(", "\\)"],
          ],
        },
      };
    </script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <h1>Solution -ã€ŒCF 1827Cã€Palindrome Partition</h1><h2>Desc.</h2>
<p><a href="https://codeforces.com/problemset/problem/1827/C">Link.</a></p>
<p>å®šä¹‰<strong>å¥½ä¸²</strong>ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå¶å›æ–‡ä¸²æ‹¼æ¥çš„ç»“æœ. ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸², æ±‚å…¶ä¸º<strong>å¥½ä¸²</strong>çš„å­ä¸²æ•°.</p>
<h2>Sol.</h2>
<p>è€ƒè¯•çš„æ—¶å€™çŠ¯ç—…äº†, æ±‚ $f_i$ å±…ç„¶æ²¡æœ‰æƒ³åˆ°ä»»ä½•å­—ç¬¦ä¸²ç®—æ³•, è€Œå»è¿è¾¹å†™æˆäº†å›¾è®ºé¢˜... æœ‰ç‚¹ç¦»è°±. ğŸ¤”</p>
<p>å®¹æ˜“æƒ³åˆ°ä¸€ä¸ª DP, è®¾ $f_i$ è¡¨ç¤ºåœ¨ $i$ ç»“å°¾çš„æçŸ­å¶å›æ–‡ä¸²çš„é•¿åº¦, $g_i$ è¡¨ç¤ºåœ¨ $i$ ç»“å°¾çš„å¥½ä¸²æ•°é‡, æœ‰ $g$ çš„è½¬ç§»:
$
g_i = g_{i-f_i}+1
$
è‹¥ $f_i$ ä¸å­˜åœ¨åˆ™ä¸º $0$. æ¥ä¸‹æ¥è€ƒè™‘æ€ä¹ˆæ±‚ $f_i$.</p>
<p>æˆ‘ä»¬å…ˆæ±‚å‡º $rad_i$ è¡¨ç¤ºä»¥<strong>é—´éš”</strong> $i$ ä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²é•¿åº¦, è¿™ä¸ªå¯ä»¥ç”¨å„ç§å§¿åŠ¿æ±‚, æ¯”å¦‚äºŒåˆ† &amp; å“ˆå¸Œ, PAM, Manacher etc. ç„¶åå‘ç° $f_i$ å¯ä»¥ç”¨ä¸€ä¸ª $rad_j$ æ¥æ›´æ–°, å…¶ä¸­ $j &lt; i, j+rad_j \geqslant i$. æˆ‘ä»¬è‚¯å®šå¸Œæœ› $i$ å’Œ $j$ é å¾—è¶Šè¿‘è¶Šå¥½. äºæ˜¯å€’ç€æ‰«æ, ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¿ç»­æ®µ, ä»¥ $rad_i$ æ›´æ–°è¿ç»­æ®µ. è¿™ä¸ªæœ‰ç‚¹æ²¡è¯´æ¸…æ¥š, å…·ä½“å¯ä»¥çœ‹ä»£ç , ä»£ç åº”è¯¥ä¼šæ›´å¥½ç†è§£.</p>
<pre><code class="language-cpp">void solve() {
    int n; string tmp, s; cin &gt;&gt; n &gt;&gt; tmp;
    for (int i=0;i&lt;n;++i) s.pb(tmp[i]), s.pb(&#39;|&#39;);
    s.pop_back();
    const int m = 2*n-1;
    const ull BASE = 1331;
    vector&lt;ull&gt; pw(m);
    vector hs(2, vector&lt;ull&gt;(m+1));
    pw[0] = 1;
    for (int i=1;i&lt;m;++i) pw[i] = pw[i-1]*BASE;
    for (int i=0;i&lt;m;++i) hs[0][i+1] = hs[0][i]*BASE+s[i]-&#39;a&#39;+1;
    for (int i=m-1;i&gt;=0;--i) hs[1][i] = hs[1][i+1]*BASE+s[i]-&#39;a&#39;+1;
    const auto getHash = [&amp;](int l, int r, int idx) {
        if (idx == 0) return hs[0][r]-hs[0][l]*pw[r-l];
        return hs[1][l]-hs[1][r]*pw[r-l];
    };
    vi rad(m);
    for (int i=0;i&lt;m;++i) {
        int l = 0, r = min(i, m-i-1), res = 0;
        while (l &lt;= r) {
            int mid = (l+r)/2;
            if (getHash(i-mid, i, 0) == getHash(i+1, i+mid+1, 1)) l = mid+1, res = mid;
            else r = mid-1;
        }
        rad[i] = res;
    }
    vi fa(m);
    iota(allu(fa), 0);
    const auto find = [&amp;](int u) {
        while (u != fa[u]) u = fa[u] = fa[fa[u]];
        return u;
    };
    vi f(n);
    for (int i=m-2;i&gt;=0;i-=2) {
        for (int j;(j=find(i+rad[i]))&gt;=i;) {
            if (j%2 == 0) f[j/2] = (j-i+1)/2;
            fa[j] = j-1;
        }
    }
    vll g(n);
    for (int i=0;i&lt;n;++i)
        if (f[i]) {
            if (i/2 &gt;= f[i]) g[i] = g[i-2*f[i]]+1;
            else g[i] = 1;
        }
    cout &lt;&lt; accumulate(allu(g), 0ll) &lt;&lt; &quot;\n&quot;;
}
</code></pre>
<hr>
<blockquote>
<p>/ å…‰ä¸å½±ã€€æ˜¯å¦ä¸è¯¥åœ¨è¿™ä¸€åˆ»ç›¸é€¢ /</p>
<p>/ è€Œä½ å’Œæˆ‘ä»æ¥è°ä¹Ÿä¸æ˜¯è°çš„é™„åº¸ /</p>
<p>/ æˆ‘æ”¾é€è‡ªå·±æ®‹ç¼ºçš„é­‚é­„ /</p>
<p>/ åœ¨é•œå­èƒŒé¢é‚£ä¸€å›½ /</p>
<p>/ ä¸€è·¯ä¸Šä»æ²¡æœ‰æŒ½ç•™è¿‡ /</p>
<p>/ é‚£äº›å¾’åŠ³å¥”æ³¢ã€€å´ä¸æ›¾å®Œæ•´çš„æˆ‘ /</p>
<p>â€”â€” <a href="https://vocadb.net/S/291185/">Kide - <em>é›¶å’Œ Zero-Sum</em> ft. Minus</a></p>
</blockquote>

    <script src="../components/layout.js"></script>
  </body>
</html>
