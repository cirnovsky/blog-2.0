---
date: '2022-07-11'
title: 'Summary -ã€ŒBasic Number Theory | Re-learnã€'

---



å‰ç½®å®¹æ–¥åŸç†ï¼Œæœ€ç²¾ç®€çš„å½¢å¼åº”å½“å¦‚æ­¤å†™æˆï¼š

> æœ‰ $n$ ä¸ªé›†åˆ $A_1, \dots, A_n$ï¼Œè®° $S = \{A_1, \dots, A_n\}$ã€‚
>
> åˆ™æœ‰ $\displaystyle\left|\bigcup_{i = 1}^n A_i\right|=\sum_{T\in2^{S}}(-1)^{|T|-1}\left|\bigcap_{X\in T}X\right|$ã€‚

è€ƒå¯Ÿæ¬§æ‹‰å‡½æ•°é€šé¡¹å…¬å¼ï¼Œä¸å¦¨ä»å®¹æ–¥çš„è§’åº¦æ¥ç†è§£ï¼š

> æ¬²è¯æ˜ $\displaystyle\varphi(n) = n\prod_{i=1}^{k}\left(1-\frac{1}{p_i}\right)$ã€‚
>
> **P.f.**ï¼šä»¤ $A_i$ è¡¨ç¤º $p_i$ çš„å€æ•°é›†åˆï¼ˆå…± $k$ ä¸ªè¿™æ ·çš„é›†åˆï¼‰ï¼Œå¹¶ä¸”è¿™äº›å€æ•° $\leqslant n$ï¼Œ$S = \{A_1, \dots, A_k\}$ï¼Œå¯çŸ¥ $\left|A_i\right| = \lfloor\frac{n}{p_i}\rfloor$ã€‚åˆ™ $\displaystyle\varphi(n) = n-\left|\bigcup_{i=1}^k A_i\right|=n-\sum_{T\in2^{S}}(-1)^{|T|-1}\left|\bigcap_{X\in T}X\right|=n-\sum_{T\in2^{S}}(-1)^{|T|-1}\frac{n}{\prod p}=n-\left(\sum_{i=1}^k\frac{n}{p_i}\right)+\left(\sum_{i=1}^k\sum_{j=i+1}^{k}\frac{n}{p_ip_j}\right)-\cdots=n
\left(1-\left(\sum_{i=1}^k\frac{1}{p_i}\right)+\left(\sum_{i=1}^k\sum_{j=i+1}^{k}\frac{1}{p_ip_j}\right)-\cdots\right) = n\prod_{i=1}^k\left(1-\frac{1}{p_i}\right)$ã€‚

è§£é‡Šä¸€ä¸‹æ¨å¯¼çš„æœ€åä¸€æ­¥ï¼Œè€ƒè™‘ç»„åˆæ„ä¹‰ï¼Œr.h.s. ç›¸å½“äºåœ¨å¤šé¡¹å¼å‡‘ç³»æ•°ï¼Œ$1$ è¡¨ç¤ºä¸é€‰ï¼Œ$\frac{1}{p}$ è¡¨ç¤ºé€‰ï¼Œé€‰å¥‡æ•°ä¸ªç¬¦å·ä¸ºè´Ÿï¼Œé€‰å¶æ•°ä¸ªç¬¦å·ä¸ºæ­£æ°å¥½å¯¹åº” l.h.s.ï¼ˆæˆ‘è§‰å¾—èƒ½ä»å·¦è¾¹æ¨åˆ°å³è¾¹è¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼‰ã€‚

ä»ç§¯æ€§çš„è§’åº¦ï¼š

> **P.f.**ï¼šæ˜“è¯ $\varphi(p^\alpha)=p^\alpha-p^{\alpha-1}$ï¼ˆè€ƒè™‘æŒ‰ $[1,\dots p], [p+1, \dots, 2p], \dots, [p^{\alpha-1}+1, p^\alpha]$ åˆ†ç»„ï¼Œå‘ç°åªæœ‰æ¯ç»„çš„æœ€åä¸€ä¸ªæ•° $\not\perp p^\alpha$ï¼Œè€Œè¿™æ ·çš„ç»„ä¸€å…±æœ‰ $p^{\alpha-1}$ï¼‰ï¼Œé‚£ä¹ˆ $\displaystyle\varphi(n) = \prod_{i=1}^k\varphi(p_i^{\alpha_{i}}) = \prod_{i=1}^k\left(p_i^{\alpha_{i}}-p_i^{\alpha_i-1}\right)=n\prod_{i=1}^k\left(1-\frac{1}{p_i}\right)$ã€‚

ç»“åˆä»¥ä¸Šä¸¤ç§è¯æ˜å¯ä»¥é¡ºä¾¿è¯æ˜æ¬§æ‹‰å‡½æ•°çš„ç§¯æ€§ã€‚

---

å†™å‡º CRT æ‰€è§£å†³çš„çº¿æ€§åŒä½™æ–¹ç¨‹ç»„é—®é¢˜ï¼š

> æ±‚è§£æ–¹ç¨‹ $x\equiv a_i\pmod{p_i}$ã€‚
>
> **Sol.**ï¼šè€ƒè™‘æ„é€ 

å’•å’•å’•

---

ç±»æ¬§å‡ é‡Œå¾—ã€‚

> ç»™å®šéè´Ÿæ•´æ•° $n,a,b,c$ï¼Œæ±‚ $f(n, a, b, c) = \displaystyle\sum_{i=1}^n\lfloor\frac{ai+b}{c}\rfloor$
>
> **Sol. pt 1**ï¼šé¦–å…ˆè‹¥ $a\geqslant c$ï¼Œæˆ– $b\geqslant c$ æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹å–æ¨¡å¹¶æå‰è®¡ç®—è´¡çŒ®çš„æ–¹å¼å°† $a<c$ï¼Œ$b<c$ çš„å‡è®¾ä¸€èˆ¬åŒ–ã€‚äºæ˜¯ä¸å¦¨è®¾ $a<c$ï¼Œ$b<c$ï¼Œè®¾ $m=\lfloor\frac{an+b}{c}\rfloor$ï¼Œä¹Ÿå°±æ˜¯æ±‚å’Œé¡¹ä¸­çš„æœ€å¤§å€¼ï¼ˆéè´Ÿæ•´æ•°ï¼‰ï¼Œç”±äº $\displaystyle\forall x\in\mathbb{N},x=\sum_{i=1}^{+\infty}[i \leqslant x]$ï¼Œæ‰€ä»¥åŸå¼ç­‰äº $\displaystyle\sum_{i=1}^n\sum_{j=1}^{m}[j \leqslant \lfloor \frac{ai+b}{c} \rfloor]=\sum_{j=1}^m \sum_{i=1}^n [ai \geqslant cj-b]=nm-\sum_{j=1}^m \sum_{i=1}^n [ai \leqslant cj-b-1]=nm-\sum_{j=1}^m \sum_{i=1}^n [i \leqslant \lfloor\frac{cj-b-1}{a}\rfloor] = nm-f(m, c, -b-1, a)$ï¼Œåˆ°è¿™é‡Œä½ ä¼šå‘ç°æœ‰ç‚¹ä¸å¯¹å¤´ï¼Œæˆ‘åº”è¯¥è¦ä¿è¯ $-b-1$ æ˜¯éè´Ÿæ•´æ•°ï¼Œä½†æ˜¯è¿™ä¸å¤ªå¯èƒ½ï¼Œè€ƒè™‘åˆ° $b$ è¿™ä¸ªä½ç½®è´¡çŒ®çš„æ–¹å¼ï¼Œæˆ‘ä»¬ä¹Ÿè®¸éœ€è¦è€ƒè™‘æ›´æ”¹ $f$ çš„å®šä¹‰ã€‚
>
> **Sol. pt 2**ï¼šæ›´æ”¹å®šä¹‰ $f(n, a, b, c) = \displaystyle\sum_{i=\color{red}0}^n\lfloor\frac{ai+b}{c}\rfloor$ï¼Œæ¨å¯¼è¿‡ç¨‹å¤§ä½“ç›¸åŒï¼ˆæœ‰äº›ç»†èŠ‚å¯ä»¥å‚çœ‹ $g$ï¼Œ$h$ çš„æ¨å¯¼ï¼‰ï¼Œæœ€ç»ˆçš„ç»“è®ºæ˜¯ $f(n, a, b, c) = nm-f(m-1, c, c-b-1, a)$ï¼Œè¿™ä¿è¯äº†éè´Ÿæ•´æ•°çš„å‰æï¼ˆæ³¨æ„è¾¹ç•Œæ¡ä»¶çš„è®¡ç®—æœ‰æ‰€æ”¹å˜ï¼‰ã€‚

è®©æˆ‘ä»¬å®šä¹‰ $\displaystyle s_k(n) = \sum_{i=1}^n i^k$ã€‚

å¤§è‡´ä»£ç é•¿è¿™æ ·ï¼š

```cpp
int floor_sum(LL n, int a, int b, int c) {
    // @returns: \sum_{i=0}^n floor((ai+b)/c)
    if (a == 0) {
        return mul(safe_mod(n+1), safe_mod(b/c));
    }
    if (a >= c || b >= c) {
        return add(floor_sum(n, a%c, b%c, c), mul(s(n), safe_mod(a/c)), mul(safe_mod(n+1), safe_mod(b/c)));
    }
    LL m = (a*n+b)/c;
    return sub(mul(safe_mod(n), safe_mod(m)), floor_sum(m-1, c, c-b-1, a));
}
```

> ç»™å®šéè´Ÿæ•´æ•° $n, a, b, c$ï¼Œæ±‚ $g(n, a, b, c) = \sum_{i=0}^n \lfloor\frac{ai+b}{c}\rfloor^2$ï¼Œ$h(n, a, b, c) = \sum_{i=0}^n i\lfloor \frac{ai+b}{c} \rfloor$
>
> __Sol.__ï¼šæ±²å–å…ˆå‰çš„æ•™è®­ï¼Œæˆ‘ä»¬å°† $0$ å›Šæ‹¬è¿›äº†å’Œå¼ã€‚åŒæ—¶åœ¨çœ‹äº†é¢˜è§£æ¨å¯¼çš„è¿‡ç¨‹åï¼Œæˆ‘ä»¬å¯ä»¥æ›´åŠ æˆç†Ÿåœ°å¯¹é—®é¢˜è¿›è¡Œåˆ†ç±»è®¨è®ºã€‚
>
> - $g$
>   - $c \leqslant \max\{a, b\}$ï¼š$\displaystyle g(n, a, b, c) = \sum_{i=0}^n \left( \lfloor\frac{(a\bmod c)i+b\bmod c}{c}+i \lfloor \frac{a}{c} \rfloor+\lfloor \frac{b}{c} \rfloor \rfloor \right)^2 = g(n, a \bmod c, b \bmod c, c)+2\lfloor \frac{a}{c} \rfloor h(n, a\bmod c, b \bmod c, c) + 2 \lfloor \frac{b}{c} \rfloor f(n, a \bmod c, b \bmod c, c) + s_2(n)\lfloor \frac{a}{c} \rfloor ^ 2  +  n(n+1)\lfloor \frac{a}{c} \rfloor \lfloor \frac{b}{c} \rfloor + (n+1)\lfloor \frac{b}{c} \rfloor ^ 2$ã€‚
>
>   - $c > \min\{a, b\}$ï¼šé¦–å…ˆæ³¨æ„åˆ° $x^2 = x(x+1)-x = 2s_1(x) - x$ï¼Œä»¤ $m=\lfloor \frac{an
>+b}{c} \rfloor$ï¼Œå› æ­¤ $\displaystyle g(n, a, b, c) = \sum_{i=0}^n \lfloor \frac{ai+b}{c}^2 \rfloor = 2\left(\sum_{i=0}^n \sum_{j=1}^{\lfloor \frac{ai+b}{c} \rfloor}j\right)-\left(\sum_{i=0}^n\lfloor \frac{ai+b}{c} \rfloor\right) = 2\left(\sum_{i=0}^n\sum_{j=0}^{m-1
} (j+1)[j < \lceil \frac{ai+b-c+1}{c} \rceil]\right) - f(n, a, b, c) = 2\left(\sum_{j=0}^{m-1
} (j+1) \sum_{i=0}^n [i > \lfloor \frac{cj-b+c-1}{a} \rfloor]\right) - f(n, a, b, c) = 2\left(\sum_{j=0}^{m-1
} (j+1) \left(n - \lfloor \frac{cj-b+c-1}{a} \rfloor\right)\right) - f(n, a, b, c) = 2n\times s_1(m) - 2h(m-1, c, c-b-1, a) - 2f(m-1, c, c-b-1, a) - f(n, a, b, c)$ã€‚
>
> - $h$
>   - $c \leqslant \max\{a, b\}$ï¼š$h(n, a, b, c) = h(n, a \bmod c, b \bmod c, c) + s_1(n) \lfloor \frac{b}{c} \rfloor + s_2(n) \lfloor \frac{a}{c} \rfloor$ã€‚
>   - $c > \min\{a, b\}$ï¼š$\displaystyle h(n, a, b, c) = \sum_{i=0}^n i\lfloor \frac{ai+b}{c} \rfloor = \sum_{i=0}^ni\sum_{j=0}^{m-1}[cj < ai+b-c+1] = \sum_{j=0}^{m-1}\sum_{i=0}^ni[i > \lfloor \frac{cj+c-b-1}{a} \rfloor] = \sum_{j=0}^{m-1}\left(s_1(n)-\sum_{i=0}^n i[i \leqslant \lfloor \frac{cj+c-b-1}{a} \rfloor]\right) = \sum_{j=0}^{m-1} s_1(n)-s_1(\lfloor \frac{cj+c-b-1}{a} \rfloor) = m\times s_1(n)-\frac{\sum_{j=0}^{m-1}\left(\lfloor \frac{cj+c-b-1}{a} \rfloor^2+\lfloor \frac{cj+c-b-1}{a} \rfloor\right)}{2} = s_1(n)\times m - f(m-1, c, c-b-1, a) - g(m-1, c, c-b-1, a)$ã€‚

è€ƒè¯•ç»™ğŸ‘´é‡åˆ°äº†å°±ä¸‹åœ°ç‹±å§ã€‚

æœ€åçš„ä»£ç è¿˜æ˜¯æœ‰ç‚¹è¯´å¤´ï¼Œå¾ˆè¯¡ç§˜çš„æ˜¯ï¼Œç”¨å‡½æ•°å¼å–æ¨¡ä¼š T é£ï¼Œä¸‰ä¸ªå‡½æ•°ä¸€èµ·å†™ä¼š Waï¼Œåæ­£æœ€åçš„ç»“å±€å°±æ˜¯ `modint`+æŠ„ä»£ç ã€‚

```cpp
tpl floor_sum(LL n, int a, int b, int c) {
    if (a == 0) {
        return {mi(n+1)*(b/c), mi(n+1)*sqr(b/c), s(n)*(b/c)};
    }
    if (a >= c || b >= c) {
        tpl ret = floor_sum(n, a%c, b%c, c);
        return {
            ret.f+s(n)*(a/c)+mi(n+1)*(b/c),
            ret.g+mi(2)*(a/c)*ret.h+mi(2)*(b/c)*ret.f+s2(n)*sqr(a/c)+mi(2)*s(n)*(a/c)*(b/c)+mi(n+1)*sqr(b/c),
            ret.h+s(n)*(b/c)+s2(n)*(a/c)
        };
    }
    LL m = (a*n+b)/c;
    tpl ret = floor_sum(m-1, c, c-b-1, a);
    return {
        mi(n)*m-ret.f,
        mi(2)*n*s(m)-2*ret.h-2*ret.f-(mi(n)*m-ret.f),
        s(n)*m-ret.f*iv2-ret.g*iv2
    };
}
```

---

é˜¶ï¼ŒåŸæ ¹ï¼Œè¿˜æœ‰ï¼Œï¼Œï¼Ÿ

å­¦æ•°è®ºï¼Œå°±å¥½æ¯”åƒshitã€‚åƒshitå•Šåƒshit



> **é˜¶ multiplicative order**ï¼šåœ¨ $(a, m) = 1$ çš„æƒ…å†µä¸‹ï¼Œæå°çš„æ»¡è¶³ $a ^ n \equiv 1 \pmod m$ çš„æ­£æ•´æ•° $n$ ç§°ä½œ $a$ æ¨¡ $m$ çš„é˜¶ï¼Œè®°ä½œ $\delta_m(a)$ã€‚
>
> ç”±äºæ¬§æ‹‰å®šç†ï¼Œæ‰€ä»¥é˜¶ä¸€å®šå­˜åœ¨ï¼ˆè‡³å°‘æœ‰ä¸€ä¸ª $\varphi(m)$ï¼‰ã€‚æ¥ä¸‹æ¥æ‰¯å‡ ä¸ªæ€§è´¨ï¼š
> - $\{1, a^2, \dots, a^{\delta_m(a)}-1\}$ æ˜¯æ¨¡ $m$ çš„ç¼©ç³»ã€‚
> - 